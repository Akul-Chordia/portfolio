<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akul Chordia - Web Portfolio (ImGui Theme)</title>
    <!-- Importing 'Roboto Mono' as a fallback font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* @font-face rule to load your local font file */
        @font-face {
            font-family: 'ProggyClean';
            /* This tells the browser to look for the font file in the same folder */
            src: url('ProggyClean.ttf') format('truetype');
            /* These settings help it render sharply like a bitmap font */
            font-weight: normal;
            font-style: normal;
            font-synthesis: none;
        }

        /* --- Base Styling --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* Split html and body rules */
        html {
            /* Font size is now on HTML element, default 17px */
            font-size: 17px; 
        }

        body {
            width: 100%;
            height: 100%;
            overflow: hidden; /* Will be overridden on mobile */
            /* main background color (this is now a fallback) */
            background-color: rgb(51, 51, 51); 
            color: #E0E0E0; /* Default light text */
            /* Updated font stack */
            font-family: 'ProggyClean', 'Roboto Mono', 'Courier New', 'Bitstream Vera Sans Mono', monospace;
            line-height: 1.4;
            
            /* Force crisp pixel rendering */
            image-rendering: -moz-crisp-edges; /* Firefox */
            image-rendering: pixelated; /* Modern browsers */
            
            /* Disable font smoothing for a sharper, bitmap-like look */
            -webkit-font-smoothing: none;
            -moz-osx-font-smoothing: grayscale;
            font-smooth: never;
            
            transition: background-color 0.2s, color 0.2s;
        }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar {
            width: 12px; 
            height: 12px; 
        }
        ::-webkit-scrollbar-track {
            /* Use window background color */
            background: rgb(17, 17, 17);
        }
        ::-webkit-scrollbar-thumb {
            background: #555;
            /* Use window background color for border */
            border: 3px solid rgb(17, 17, 17); 
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #777;
        }
        ::-webkit-scrollbar-corner {
            background: rgb(51, 51, 51);
        }
        
        /* --- Window Container for Scaling --- */
        #window-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transition: transform 0.1s; /* Smooths scale reset */
        }

        /* --- ImGui Window Structure --- */
        .imgui-window {
            position: absolute;
            /* individual window background */
            background-color: rgb(17, 17, 17); 
            border: 1px solid #353535; 
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            min-width: 280px; 
            min-height: 180px; 
            display: grid;
            grid-template-rows: auto 1fr;
            overflow: hidden;
            transition: background-color 0.2s, border-color 0.2s;
        }

        /* --- Window Title Bar --- */
        .imgui-title-bar {
            padding: 4px 8px; 
            /* title black (not selected) */
            background-color: rgb(10, 10, 10); 
            color: #E0E0E0;
            font-weight: 700; 
            cursor: move;
            user-select: none;
            border-bottom: 1px solid #000; /* Darker border */
            transition: background-color 0.2s, color 0.2s, border-color 0.1s;
            /* Use flex to position title and collapse button */
            display: flex;
            align-items: center;
        }

        /* NEW: Class for window title text */
        .window-title-text {
            font-size: 1.1rem;
            vertical-align: middle; /* Align with collapse button */
        }

        /* Active Window Title Bar */
        .imgui-window.active > .imgui-title-bar {
            /* title bar blue (when window selected) */
            background-color: rgb(41, 74, 122); 
        }

        /* Collapse Button */
        .window-collapse-btn {
            font-size: 0.9em; /* Match summary arrow */
            font-weight: 700;
            padding: 0 5px;
            cursor: pointer;
            border-radius: 2px;
            transition: transform 0.1s linear, background-color 0.1s;
            transform: rotate(90deg); /* Start open (rotated) */
            margin-right: 6px; 
        }
        .window-collapse-btn:hover {
            background-color: rgb(56, 123, 203);
        }

        /* Collapsed Window Styling */
        .imgui-window.collapsed {
            height: auto !important; /* Override inline style */
            /* Make window box disappear */
            background-color: transparent;
            border: none;
            box-shadow: none;
            min-height: 0;
            min-width: 0; /* Let title bar define width */
        }
        .imgui-window.collapsed > .imgui-content,
        .imgui-window.collapsed > .imgui-resize-handle {
            display: none; /* Hide content and resizer */
        }
        .imgui-window.collapsed > .imgui-title-bar {
            background-color: rgb(25, 25, 25); /* Collapsed color */
            border: 1px solid #353535; /* Add border to bar */
        }
        /* Collapsed and active (collapsed color wins) */
        .imgui-window.collapsed.active > .imgui-title-bar {
             background-color: rgb(25, 25, 25); /* Collapsed color */
        }
        
        /* Rotate button when collapsed */
        .imgui-window.collapsed .window-collapse-btn {
            transform: rotate(0deg); /* Point right when collapsed */
        }


        /* --- Window Content Area --- */
        .imgui-content {
            padding: 10px; 
            overflow-y: auto;
            /* individual window background */
            background-color: rgb(17, 17, 17); 
            transition: background-color 0.2s;
        }

        /* --- Resize Handle (Bottom-Right Corner) --- */
        .imgui-resize-handle {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 15px; 
            height: 15px; 
            cursor: se-resize;
            /* Updated background to match window */
            background:
                linear-gradient(135deg, rgb(17, 17, 17) 0%, rgb(17, 17, 17) 60%, #777 60%, #777 65%, transparent 65%),
                linear-gradient(135deg, rgb(17, 17, 17) 0%, rgb(17, 17, 17) 75%, #777 75%, #777 80%, transparent 80%),
                linear-gradient(135deg, rgb(17, 17, 17) 0%, rgb(17, 17, 17) 90%, #777 90%, #777 95%, transparent 95%);
            opacity: 0.9;
            transition: background 0.2s;
        }

        /* --- Content Styling (Separators, Lists, etc.) --- */
        hr {
            border: 0;
            border-top: 1px solid #353535;
            margin: 10px 0; 
            transition: border-color 0.2s;
        }
        
        ul {
            list-style: none;
            padding-left: 22px; 
        }
        
        li {
            position: relative;
            margin-bottom: 5px; 
        }
        
        li::before {
            content: '-';
            position: absolute;
            left: -18px; 
            color: #888;
        }

        /* --- Collapsible Sections (Dropdowns) --- */
        details {
            margin-bottom: 6px; 
            border: 1px solid #000; /* Darker border */
            /* not hover in closed subtitle */
            background-color: rgb(32, 58, 89); 
            transition: background-color 0.2s, border-color 0.2s;
        }
        
        summary {
            cursor: pointer;
            padding: 4px 8px; 
            font-weight: 700; 
            list-style: none;
            user-select: none;
            transition: background-color 0.1s;
        }

        /* Hover for ALL headers (open or closed) */
        summary:hover {
            /* hover on a subsection subtitle */
            background-color: rgb(56, 123, 203); 
        }
        
        /* The blue color when open */
        details[open] > summary {
            /* Match active title bar blue */
            background-color: rgb(41, 74, 122);
            border-bottom: 1px solid #000;
        }
        /* Hover for open (overrides default hover) */
        details[open] > summary:hover {
            /* hover on a subsection subtitle */
            background-color: rgb(56, 123, 203); 
        }


        /* Custom arrow */
        summary::before {
            content: '►';
            display: inline-block;
            margin-right: 8px; 
            font-size: 0.9em;
            transition: transform 0.1s linear;
        }
        
        details[open] > summary::before {
            transform: rotate(90deg);
        }
        
        /* Content inside a <details> dropdown */
        .details-content {
            padding: 10px; 
            /* individual window background */
            background-color: rgb(17, 17, 17); 
            transition: background-color 0.2s;
        }
        
        /* Content inside a <details> dropdown */
        .details-content p {
            margin-bottom: 5px; 
        }
        
        /* Nested tree-node style for Skills */
        .skills-tree summary {
            background: none;
            border: none;
            padding: 2px 4px; 
            font-weight: 400; /* Tree nodes are not bold */
        }
        .skills-tree summary:hover {
            /* hover on a subsection subtitle */
            background-color: rgb(56, 123, 203);
        }
        .skills-tree details {
            background: none;
            border: none;
            margin-left: 12px; 
        }
        .skills-tree details[open] > summary {
             background-color: transparent; /* No blue for tree nodes */
             border: none;
        }
        .skills-tree .details-content {
            padding: 5px 0 5px 22px; 
            border: none;
        }
        .skills-tree p {
            color: #BBB; /* Slightly dimmer text for content */
            transition: color 0.2s;
        }

        /* --- Link Styling --- */
        a, a:visited {
            color: #5E98D9; /* A blue that fits the theme */
            text-decoration: none;
            cursor: pointer;
            transition: color 0.2s;
        }
        a:hover {
            text-decoration: underline;
            color: #7EAFE9;
        }
        
        /* Link styling for Summary headers */
        summary a, summary a:visited {
            color: inherit;
            text-decoration: none;
        }
        summary a:hover {
            text-decoration: underline;
        }

        /* Small link inside project dropdowns */
        .project-link {
            font-size: 0.8em; /* Smaller font */
            margin-top: 10px;
        }
        
        /* Styling for "Other Projects" list */
        .other-projects-list li a {
            color: #E0E0E0; /* White, non-underlined link */
            text-decoration: none;
            transition: color 0.2s;
        }
        .other-projects-list li a:hover {
            color: #7EAFE9; /* Standard hover color */
            text-decoration: underline;
        }
        
        /* Debug Radio Buttons */
        .debug-radio-group {
            display: flex !important; /* Override .debug-widget display:block */
            gap: 10px;
            align-items: center;
        }
        .debug-radio-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }
        .debug-radio-group input[type="radio"] {
            margin-right: 5px;
        }

        /* Debug window font fix */
        #debug-window {
            font-size: 16px !important; /* Keep debug window font size constant */
        }


        /* ================================================= */
        /* --- Light Mode Theme --- */
        /* ================================================= */

        body.light-mode {
            background-color: #D6D6D6; /* Lighter main background */
            color: #2E2E2E; /* Dark text */
        }

        /* --- Light Mode Scrollbar --- */
        body.light-mode ::-webkit-scrollbar-track {
            background: #FFFFFF;
        }
        body.light-mode ::-webkit-scrollbar-thumb {
            background: #999;
            border-color: #FFFFFF;
        }
        body.light-mode ::-webkit-scrollbar-thumb:hover {
            background: #777;
        }
        body.light-mode ::-webkit-scrollbar-corner {
            background: #D6D6D6;
        }

        /* --- Light Mode Window --- */
        body.light-mode .imgui-window {
            background-color: #FFFFFF;
            border: 1px solid #AAAAAA;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        body.light-mode .imgui-title-bar {
            background-color: #F0F0F0; /* Light gray title */
            color: #2E2E2E;
            border-bottom: 1px solid #AAAAAA;
        }
        body.light-mode .imgui-window.active > .imgui-title-bar {
            background-color: #B4C7E0; /* Light blue active */
        }
        body.light-mode .imgui-content {
            background-color: #FFFFFF;
        }

        /* --- Light Mode Resize Handle --- */
        body.light-mode .imgui-resize-handle {
            background:
                linear-gradient(135deg, #FFFFFF 0%, #FFFFFF 60%, #999 60%, #999 65%, transparent 65%),
                linear-gradient(135deg, #FFFFFF 0%, #FFFFFF 75%, #999 75%, #999 80%, transparent 80%),
                linear-gradient(135deg, #FFFFFF 0%, #FFFFFF 90%, #999 90%, #999 95%, transparent 95%);
        }
        
        /* --- Light Mode Content --- */
        body.light-mode hr {
            border-top: 1px solid #DDDDDD;
        }
        body.light-mode li::before {
            color: #888;
        }
        body.light-mode .skills-tree p {
            color: #555;
        }

        /* --- Light Mode Links --- */
        body.light-mode a, body.light-mode a:visited {
            color: #005A9C;
        }
        body.light-mode a:hover {
            color: #0078D4;
        }
        body.light-mode .other-projects-list li a {
            color: #2E2E2E; /* Dark text */
        }
        body.light-mode .other-projects-list li a:hover {
            color: #0078D4;
        }

        /* --- Light Mode Collapsibles --- */
        body.light-mode details {
            border: 1px solid #AAAAAA;
            background-color: #D3E0ED; /* Closed subtitle */
        }
        body.light-mode details[open] > summary {
            background-color: #B4C7E0; /* Open subtitle */
            border-bottom: 1px solid #AAAAAA;
        }
        body.light-mode summary:hover {
            background-color: #C8D8E8; /* Hover subtitle */
        }
        body.light-mode details[open] > summary:hover {
            background-color: #C8D8E8; /* Hover (open) */
        }
        body.light-mode .details-content {
            background-color: #FFFFFF;
        }
        
        /* --- Light Mode Widgets (in JS) --- */
        body.light-mode .debug-widget {
            color: #2E2E2E;
        }
        
        body.light-mode #resume-button,
        body.light-mode #reset-layout-button,
        body.light-mode #portfolio-button { /* Added portfolio button */
            background-color: #B4C7E0;
            border-color: #B4C7E0;
            color: #2E2E2E;
        }
        body.light-mode #resume-button:hover,
        body.light-mode #reset-layout-button:hover,
        body.light-mode #portfolio-button:hover { /* Added portfolio button */
            background-color: #C8D8E8;
            border-color: #C8D8E8;
        }
        body.light-mode #resume-button:active,
        body.light-mode #reset-layout-button:active,
        body.light-mode #portfolio-button:active { /* Added portfolio button */
            background-color: #A0B9D6;
            border-color: #A0B9D6;
        }
        
        body.light-mode #debug-slider,
        body.light-mode #font-slider {
            background: #D0D0D0;
            border-color: #FFFFFF;
        }
        body.light-mode #debug-slider::-webkit-slider-thumb,
        body.light-mode #font-slider::-webkit-slider-thumb {
            background: #B4C7E0;
            border-color: #C8D8E8;
        }
        body.light-mode #debug-slider::-webkit-slider-thumb:hover,
        body.light-mode #font-slider::-webkit-slider-thumb:hover {
            background: #C8D8E8;
        }
        body.light-mode #debug-slider::-moz-range-thumb,
        body.light-mode #font-slider::-moz-range-thumb {
            background: #B4C7E0;
            border-color: #C8D8E8;
        }
        

        /* ================================================= */
        /* --- Portfolio Overlay Styles --- */
        /* ================================================= */

        #portfolio-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
            display: none; /* Hidden by default */
            align-items: center;
            justify-content: center;
            z-index: 5000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        #portfolio-overlay.active {
            display: flex;
            opacity: 1;
        }

        #portfolio-card {
            /* iOS liquid glass effect */
            background: transparent;
            
            border-radius: 20px;
            width: 90vw;
            height: 85vh;
            max-width: 1400px;
            max-height: 900px;
            
            
            position: relative;
            overflow: visible;
            display: flex;
            flex-direction: column;
            
            transition: background 0.2s, border-color 0.2s, box-shadow 0.2s;
            
            /* NEW: Add perspective for 3D transforms */
            perspective: 1500px;
        }

        /* NEW: Animation for the border */
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        /* UPDATED: Animation logic */
        #portfolio-overlay.active #portfolio-card {
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        /* NEW: Hiding animation */
        #portfolio-overlay.hiding #portfolio-card {
            animation: popOut 0.3s ease-out forwards;
        }
        
        /* NEW: Keyframe animations for pop effect */
        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        @keyframes popOut {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0.8);
            }
        }
        
        #portfolio-close-btn {
            position: absolute;
            top: 20px;
            right: 25px;
            font-family: 'Arial', sans-serif; /* Use a standard font for 'X' */
            font-size: 2.5rem;
            font-weight: 300;
            color: #E0E0E0;
            cursor: pointer;
            z-index: 10;
            line-height: 1;
            transition: color 0.2s, transform 0.2s;
        }
        #portfolio-close-btn:hover {
            color: #FFF;
            transform: scale(1.1);
        }

        #portfolio-scroller {
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;
            width: 100%;
            height: 100%;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            z-index: 5; /* NEW: Ensure scroller is above pseudo-elements */
            position: relative; /* NEW: Establish stacking context */
        }
        
        /* Scroller scrollbar styling */
        #portfolio-scroller::-webkit-scrollbar {
            width: 10px; 
            height: 10px; 
        }
        #portfolio-scroller::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        #portfolio-scroller::-webkit-scrollbar-thumb {
            background: #555;
            border: 2px solid transparent;
            border-radius: 10px;
            background-clip: content-box;
        }
        #portfolio-scroller::-webkit-scrollbar-thumb:hover {
            background: #777;
        }


        .project-slide {
            flex: 0 0 100%;
            width: 100%;
            height: 100%;
            scroll-snap-align: start;
            padding: 40px 60px;
            padding-top: 70px; /* Make space for close button */
            overflow-y: auto;
            
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto 1fr; /* Title row, content row */
            gap: 25px;
            
            /* Match body font */
            font-family: 'ProggyClean', 'Roboto Mono', 'Courier New', 'Bitstream Vera Sans Mono', monospace;
            color: #E0E0E0;
        }
        
        .project-slide h2 {
            grid-column: 1 / -1; /* Span full width */
            font-size: 2rem; /* Larger font size */
            font-weight: 700;
            color: #FFF;
            border-bottom: 2px solid rgb(41, 74, 122);
            padding-bottom: 10px;
            margin-bottom: 10px;
        }
        
        .slide-content {
            grid-column: 1 / 2;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        .slide-content p {
            margin-bottom: 15px;
        }
        .slide-content ul {
            padding-left: 22px; /* Match resume list */
        }
        .slide-content li::before {
             content: '-';
            position: absolute;
            left: -18px; 
            color: #888;
        }
        
        .slide-media {
            grid-column: 2 / 3;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .slide-media img,
        .slide-media video {
            width: 100%;
            border-radius: 10px;
            border: 1px solid #353535;
            background-color: #000;
        }

        /* --- NEW: Styles for Project Grid (Slide 5) --- */
        .project-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 10px;
        }
        .project-grid-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #353535;
            border-radius: 8px;
            padding: 15px;
            transition: background 0.2s;
        }
        .project-grid-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        .project-grid-item h4 {
            font-weight: 700;
            color: #FFF;
            margin-bottom: 8px;
            font-size: 1.1rem; /* Match slide content font */
        }
        .project-grid-item p {
            font-size: 0.9rem;
            margin-bottom: 10px;
            color: #CCC;
        }
        .project-grid-item a {
            font-size: 0.9rem;
            font-weight: 700;
        }
        
        /* --- NEW: Fan layout for portfolio cards (Desktop-only) --- */
        @media (min-width: 801px) {
            #portfolio-scroller {
                /* Override slider styles */
                display: grid;
                place-items: center;
                /* UPDATED: Allow shadows/hover effects to be visible */
                overflow: visible; 
            }
            
            .project-slide {
                /* Override slider styles */
                grid-column: 1 / 1;
                grid-row: 1 / 1;
                width: 45%; /* USER REQUEST: Make cards narrower */
                height: 85%;
                position: absolute; /* Needed for transform and z-index */
                flex: none;
                scroll-snap-align: none;
                
                /* Set transform origin to the center */
                transform-origin: 50% 50%;
                transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), 
                            z-index 0s 0.2s; /* Delay z-index pop */
                
                /* NEW: Add frosted glass background to each slide */
                background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%), rgba(30, 30, 30, 0.65); /* More transparent */
                backdrop-filter: blur(15px) saturate(150%); /* More blur */
                -webkit-backdrop-filter: blur(15px) saturate(150%); /* More blur */
                border: 1px solid rgba(100, 100, 100, 0.2); /* Softer border */
                border-radius: 50px; /* USER REQUEST: A lot more rounded */
                box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            }

            .project-slide:hover {
                /* On hover, apply the base transform *plus* the hover effects */
                transform: var(--base-transform) translateY(-1.5rem) scale(var(--base-scale, 1) * 1.05);
                z-index: 11;
                transition: transform 0.2s cubic-bezier(0.25, 0.8, 0.25, 1),
                            z-index 0s 0s; /* No delay on hover */
            }
            
            .project-slide:active {
                /* NEW: Add a "press" effect on click */
                transform: var(--base-transform) translateY(-1.0rem) scale(var(--base-scale, 1) * 1.02);
                z-index: 10; /* Below hover, but above others */
                transition: transform 0.1s ease;
            }
            
            /* * We use CSS variables to store the "base" position of each card.
             * The :hover rule then adds to this base position.
             */
        }
        
        /* --- Light Mode: Portfolio --- */
        
        body.light-mode #portfolio-card {
            /* UPDATED: Light mode glass effect */
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 100%), rgba(255, 255, 255, 0.4);
            border-color: rgba(200, 200, 200, 0.3);
            color: #2E2E2E;
            /* Light mode glow */
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1), 
                        0 0 15px 5px rgba(180, 199, 224, 0.4); 
        }

        body.light-mode #portfolio-close-btn {
            color: #2E2E2E;
        }
        body.light-mode #portfolio-close-btn:hover {
            color: #000;
        }
        body.light-mode .project-slide {
            color: #2E2E2E;
        }
        body.light-mode .project-slide h2 {
            color: #000;
            border-bottom-color: #B4C7E0;
        }
        body.light-mode .project-slide li::before {
            color: #888;
        }
        body.light-mode .slide-media img,
        body.light-mode .slide-media video {
            border-color: #CCC;
            background-color: #EEE;
        }
        
        /* Light mode scrollbar for scroller */
        body.light-mode #portfolio-scroller::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.2);
        }
        body.light-mode #portfolio-scroller::-webkit-scrollbar-thumb {
            background: #999;
        }
        body.light-mode #portfolio-scroller::-webkit-scrollbar-thumb:hover {
            background: #777;
        }

        /* --- NEW: Light mode for grid --- */
        body.light-mode .project-grid-item {
            background: rgba(0, 0, 0, 0.02);
            border-color: #DDD;
        }
        body.light-mode .project-grid-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }
        body.light-mode .project-grid-item h4 {
            color: #000;
        }
        body.light-mode .project-grid-item p {
            color: #333;
        }


        /* --- Responsive Media Query for Mobile --- */
        @media (max-width: 800px) {
            html, body {
                overflow: auto; /* Enable scrolling on mobile */
            }
            
            #window-container {
                /* Disable scaling on mobile */
                transform: none !important;
                /* Panning container needs to be relative */
                position: relative !important;
                top: auto !important;
                left: auto !important;
            }

            .imgui-window {
                /* Override all desktop positioning */
                position: relative !important;
                width: calc(100% - 20px) !important; /* Full width with margin */
                height: auto !important; /* Auto height */
                top: auto !important;
                left: auto !important;
                margin: 10px;
                z-index: auto !important;
            }

            /* Hide fixed debug window on mobile, stack it normally */
            .imgui-window[style*="position: fixed"] {
                position: relative !important;
                right: auto !important;
                width: calc(100% - 20px) !important;
                height: auto !important;
                margin: 10px;
                z-index: auto !important;
            }

            .imgui-resize-handle {
                display: none; /* Hide resize handle on mobile */
            }

            .imgui-title-bar {
                cursor: default; /* No 'move' cursor on mobile */
            }
            
            /* Hide canvas on mobile for performance */
            #background-canvas {
                display: none;
            }
            
            /* --- Portfolio Mobile --- */
            #portfolio-card {
                width: 100vw;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
            }
            /* Hide futuristic effects on mobile for performance/cleanliness */
            #portfolio-card::before, #portfolio-card::after {
                display: none;
            }
            .project-slide {
                grid-template-columns: 1fr; /* Stack content vertically */
                grid-template-rows: auto auto 1fr; /* Title, Content, Media */
                padding: 20px;
                padding-top: 60px;
            }
            .slide-content {
                grid-column: 1 / -1;
            }
            .slide-media {
                grid-column: 1 / -1;
            }
            #portfolio-close-btn {
                top: 15px;
                right: 20px;
            }
            
            /* --- NEW: Mobile responsiveness for grid --- */
            .project-grid {
                /* Stack grid items on mobile */
                grid-template-columns: 1fr;
            }
        }
        
        /* Added a specific breakpoint for the grid on small-ish screens */
        @media (max-width: 500px) {
             .project-grid {
                grid-template-columns: 1fr;
             }
        }


        /* --- Background Canvas --- */
        #background-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Behind windows but in front of body bg */
            pointer-events: none; /* Let clicks pass through */
        }

    </style>
</head>
<body>
    
    <canvas id="background-canvas"></canvas>

    <div id="window-container">

        <!-- Window 1: About Me -->
        <div id="window-about" class="imgui-window"> 
            <div class="imgui-title-bar">
                <span class="window-collapse-btn" title="Collapse">►</span>
                <span class="window-title-text">About Me</span>
            </div>
            <div class="imgui-content">
                <p style="font-weight: 700;">Akul Chordia</p>
                <p>US Citizen</p>
                <hr>
                <p>Email: akulchordia04@gmail.com</p>
                <p>LinkedIn: <a href="https://linkedin.com/in/akul-chordia" target="_blank" rel="noopener noreferrer">linkedin.com/in/akul-chordia</a></p>
                <p>GitHub: <a href="https://github.com/Akul-Chordia" target="_blank" rel="noopener noreferrer">github.com/Akul-Chordia</a></p>
                <button id="resume-button" class="debug-widget" style="margin-top: 10px;">View Resume [PDF]</button>
            </div>
            <div class="imgui-resize-handle"></div>
        </div>

        <!-- Window 2: Education -->
        <div id="window-education" class="imgui-window"> 
            <div class="imgui-title-bar">
                <span class="window-collapse-btn" title="Collapse">►</span>
                <span class="window-title-text">Education</span>
            </div>
            <div class="imgui-content">
                <p style="font-weight: 700;">B.Tech Computer Science and Engineering</p>
                <p>Vellore Institute of Technology, Vellore</p>
                <p style="color: #999;">GPA: 8.24/10 (3.56/4)</p>
                <p style="color: #999;">2022-2026</p>
                <hr>
                <p style="font-weight: 700;">Diploma, Data Science and Programming</p>
                <p>Indian Institute of Technology, Madras</p>
                <p style="color: #999;">2022-2024</p>
                <hr>
                <p style="font-weight: 700;">High School Diploma</p>
                <p>Rockwoods High School, Udaipur</p>
                <p style="color: #999;">91.4%</p>
                <p style="color: #999;">2018-2022</p>
            </div>
            <div class="imgui-resize-handle"></div>
        </div>

        <!-- Window 3: Work Experience -->
        <div id="window-experience" class="imgui-window"> 
            <div class="imgui-title-bar">
                <span class="window-collapse-btn" title="Collapse">►</span>
                <span class="window-title-text">Work Experience</span>
            </div>
            <div class="imgui-content">
                <details open> 
                    <summary><a href="https://easelearn.ai" target="_blank" rel="noopener noreferrer">EaseLearn AI - Head of AI</a> (July 2025 - Present)</summary>
                    <div class="details-content">
                        <ul>
                            <li>Cut query latency 40% by implementing a scalable routing pipeline with asynchronous processing and optimized model selection logic; system has 25k+ users.</li>
                            <li>Reduced jailbreak vulnerabilities by ~85% by engineering a multi-stage defense pipeline that utilized prompt analysis, fine-tuned guardrail models, and topic restriction to create an enterprise-grade secure AI infrastructure.</li>
                        </ul>
                    </div>
                </details>
                <details> 
                    <summary><a href="https://www.niftyindices.com" target="_blank" rel="noopener noreferrer">NSE Indices Ltd. - Quantitative Research Intern</a> (May 2025 - July 2025)</summary>
                    <div class="details-content">
                        <ul>
                            <li>Collaborated on algorithmic index design, development and back testing of prototype indices, evaluating performance and market fit.</li>
                            <li>Benchmarked multiple providers to identify white-space opportunities in index design; directly contributed to strategy for new product lines where NSE had no presence.</li>
                            <li>Delivered final presentation on findings and recommendations to the CEO, VPs, and Director of NSE Indices, shaping senior leadership's roadmap for future index offerings.</li>
                        </ul>
                    </div>
                </details>
                <details open> 
                    <summary><a href="https://particleblack.com/" target="_blank" rel="noopener noreferrer">Particle Black - Data Analyst Intern</a> (Feb 2025 - May 2025)</summary>
                    <div class="details-content">
                        <ul>
                            <li>Engineered a machine learning pipeline using scikit-learn to predict real-estate sales, encompassing data ingestion, model training, and validation; application in property valuation and credit risk modeling.</li>
                            <li>Built features from raw listing data (location, price, attributes, historical sales); framework extendable to large-scale asset pricing.</li>
                        </ul>
                    </div>
                </details>
            </div>
            <div class="imgui-resize-handle"></div>
        </div>

        <!-- Window 4: Projects -->
        <div id="window-projects" class="imgui-window"> 
            <div class="imgui-title-bar">
                <span class="window-collapse-btn" title="Collapse">►</span>
                <span class="window-title-text">Projects</span>
            </div>
            <div class="imgui-content">
                <details open> 
                    <summary>OrderBook (C++)</summary>
                    <div class="details-content">
                        <ul>
                            <li>Built a high-performance agent based multi-threaded order book with OOPs based modular architecture.</li>
                            <li>Simulated realistic exchange microstructure by enabling various concurrent agents including zero-intelligence agents, market makers, TWAP, VWAP agents and HFT agents with dynamic quoting and spread, inventory skew, and general risk management.</li>
                            <li>Currently working on further academic research with a professor.</li>
                        </ul>
                        <div style="display:flex; gap:12px;">
                            <p class="project-link">
                                <a href="https://github.com/Akul-Chordia/OrderBook" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                            </p>
                            <p class="project-link">
                                <a href="https://drive.google.com/file/d/1EKnLIR5I_yJ3Pvp-evykr0w8DyEPqujV/view?usp=sharing" target="_blank" rel="noopener noreferrer">[whitepaper]</a>
                            </p>
                        </div>
                    </div>
                </details>
                <details> 
                    <summary>CPU Simulator (C++)</summary>
                    <div class="details-content">
                        <ul>
                            <li>Engineered a functional CPU from first principles using only AND/NOT gates; implemented custom assembly language.</li>
                            <li>Implemented a comprehensive CLI with program loading, step-by-step debugging, register status monitoring, and execution control.</li>
                            <li>Foundation for educational tools, hardware simulation, or low-level system research.</li>
                        </ul>
                        <p class="project-link"><a href="https://github.com/Akul-Chordia/Virtual_CPU" target="_blank" rel="noopener noreferrer">[View on GitHub]</a></p>
                    </div>
                </details>
                <details> 
                    <summary>Exon Detection (Python)</summary>
                    <div class="details-content">
                        <ul>
                            <li>Built several types of CNN optimization algorithms (PSO, PO, RIME, AVOA) for the detection and classification of Exon in human DNA.</li>
                            <li>Currently in the process of getting a research paper approved under research guide.</li>
                        </ul>
                        <p class="project-link"><a href="https://drive.google.com/file/d/1Q-LIQA9YiPvn_X9bg_QgsygbGy8X8pYL/view?usp=sharing" target="_blank" rel="noopener noreferrer">[whitepaper]</a></p>
                    </div>
                </details>
                <details>
                    <summary>Narrative Game Engine (C++)</summary>
                    <div class="details-content">
                        <ul>
                            <li>Ported Windows-based OpenGL engine to macOS reworking windowing, input, and rendering backends.</li>
                            <li>Project illustrates adaptability in systems-level engineering; foundation for future cross-platform engines.</li>
                        </ul>
                        <p class="project-link"><a href="https://github.com/Akul-Chordia/Narrative-Engine" target="_blank" rel="noopener noreferrer">[View on GitHub]</a></p>
                    </div>
                </details>
                <details open> 
                    <summary>Other Projects</summary>
                    <div class="details-content">
                        <ul class="other-projects-list">
                            <li><a href="https://github.com/Akul-Chordia/options_pricing" target="_blank" rel="noopener noreferrer">Options Pricing Black-Scholes, Binomial models, Monte Carlo (C++).</a></li>
                            <li><a href="https://github.com/Akul-Chordia/option_expiration_graph" target="_blank" rel="noopener noreferrer">Robinhood style option payoff graph (Python).</a></li>
                            <li><a href="https://github.com/Akul-Chordia/auction_pricing" target="_blank" rel="noopener noreferrer">Auction-style price discovery simulation (Python) (Maximizing fills).</a></li>
                            <li><a href="https://github.com/Akul-Chordia/Statistical_Arbitrage" target="_blank" rel="noopener noreferrer">Statistical Arbitrage - Pairs Trading Strategy (Python).</a></li>
                            <li><a href="https://github.com/Akul-Chordia/shopeasy" target="_blank" rel="noopener noreferrer">Shopeasy - Real-time cart retail system (Flutter).</a></li>
                            <li><a href="https://github.com/Akul-Chordia/bettr" target="_blank" rel="noopener noreferrer">Bettr-custom contract betting (Django).</a></li>
                            <li><a href="https://github.com/Akul-Chordia/FOCUS" target="_blank" rel="noopener noreferrer">FOCUS - LLM based ADHD diagnosis (Flask).</a></li>
                        </ul>
                        <!-- The new portfolio button is now in its own window -->
                    </div>
                </details>
            </div>
            <div class="imgui-resize-handle"></div>
        </div>

        <!-- Window 5: Achievements -->
        <div id="window-achievements" class="imgui-window"> 
            <div class="imgui-title-bar">
                <span class="window-collapse-btn" title="Collapse">►</span>
                <span class="window-title-text">Achievements</span>
            </div>
            <div class="imgui-content">
                <p style="font-weight: 700;">Hackathons</p>
                <ul>
                    <li>Winner: Central hack - VIT'S BIGGEST FLAGSHIP HACKATHON</li>
                    <li>Winner: Electra 2024 - Flask webapp for mental disorder diagnosis</li>
                    <li>Second Runner-up: ACM open reverse coding competition 2023</li>
                    <li>Winner: IIT Madras Deepracer 2023</li>
                </ul>
                <hr>
                <p style="font-weight: 700;">VIT Debate Club - Senior Core</p>
                <ul>
                    <li>Led one of India's largest debate clubs.</li>
                    <li>Organized and competed in global tournaments.</li>
                    <li>Mentored and judged school teams.</li>
                </ul>
            </div>
            <div class="imgui-resize-handle"></div>
        </div>

        <!-- Window 6: Technical Skills -->
        <div id="window-skills" class="imgui-window"> 
            <div class="imgui-title-bar">
                <span class="window-collapse-btn" title="Collapse">►</span>
                <span class="window-title-text">Technical Skills</span>
            </div>
            <div class="imgui-content">
                <p style="font-weight: 700;">Languages</p>
                <ul>
                    <li>C++, Python, R, C, SQL, Java</li>
                </ul>
                <hr>
                <p style="font-weight: 700;">Academic</p>
                <ul>
                    <li>Operating Systems, Compiler Design, Data Structures & Algorithms, DBMS, Financial Analytics</li>
                </ul>
                <hr>
                <p style="font-weight: 700;">Systems & Tools</p>
                 <ul>
                    <li>Git, Linux / Unix, Streamlit, Tableau, PowerPoint / Excel / VBA, AWS, Shell Scripting</li>
                </ul>
                <hr>
                <p style="font-weight: 700;">Finance and Data</p>
                <ul>
                    <li>Options Pricing, Monte Carlo Simulation, Statistical Arbitrage, Time Series Analysis, Portfolio Optimization</li>
                </ul>
                <hr>
                <p style="font-weight: 700;">Other</p>
                <ul>
                    <li>API Integration, Web Scraping, RESTful Systems, Low-Latency Data Pipelines</li>
                </ul>
            </div>
            <div class="imgui-resize-handle"></div>
        </div>
        
        <!-- NEW: Window 8: Portfolio Button -->
        <div id="window-portfolio-btn" class="imgui-window"> 
            <div class="imgui-title-bar">
                <span class="window-collapse-btn" title="Collapse">►</span>
                <span class="window-title-text">Portfolio</span>
            </div>
            <div class="imgui-content">
                <button id="portfolio-button" class="debug-widget" style="margin: 0;">View Full Portfolio</button>
            </div>
            <!-- UPDATED: Added resize handle -->
            <div class="imgui-resize-handle"></div>
        </div>

    </div> <!-- End of #window-container -->

    <!-- Window 7: Debug Window -->
    <div id="debug-window" class="imgui-window active" style="position: fixed; top: 20px; right: 20px; width: 280px; height: 300px; z-index: 2000;">
        <div class="imgui-title-bar">
            <span class="window-collapse-btn" title="Collapse">►</span>
            <span class="window-title-text">Debug Window</span>
        </div>
        <div class="imgui-content">
            <p id="app-stats">App: ...</p>
            <p id="mouse-stats">Mouse: (0, 0)</p>
            
            <hr>
            <!-- Theme Radio Buttons -->
            <div class="debug-radio-group debug-widget" style="margin-top: 5px;">
                <span>Theme:</span>
                <label>
                    <input type="radio" name="theme" value="dark" id="theme-dark" checked>
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" name="theme" value="light" id="theme-light">
                    <span>Light</span>
                </label>
            </div>
            <hr>
            <!-- Scale Slider -->
            <label for="font-slider" class="debug-widget">Font Size: <span id="font-value">17</span>px</label>
            <input type="range" min="10" max="25" value="17" step="1" id="font-slider">

            <!-- Reset Layout Button -->
            <button id="reset-layout-button" class="debug-widget" style="margin-top: 10px;">Reset Layout</button>
        </div>
    </div>

    <!-- 
    =================================================
    --- NEW: Portfolio Overlay HTML Structure ---
    =================================================
    -->
    <div id="portfolio-overlay">
        <div id="portfolio-card">
            <span id="portfolio-close-btn">&times;</span>
            <div id="portfolio-scroller">
                
                <!-- Slide 1: OrderBook -->
                <div class="project-slide" id="slide-1">
                    <h2>OrderBook (C++): A High-Performance Market Simulation</h2>
                    <div class="slide-content">
                        <p>This isn't just an order book; it's a complete, multi-threaded market ecosystem built from the ground up in modern C++. It simulates the complex, high-speed dynamics of a real financial exchange, proving out advanced concepts in concurrency, systems design, and quantitative strategy.</p>
                        <ul>
                            <li><strong>Advanced Matching Engine:</strong> A high-speed, single-writer matching engine that processes orders with zero lock contention, ensuring maximum throughput.</li>
                            <li><strong>Multi-Threaded Agent Ecosystem:</strong> A diverse set of AI agents (HFT, Momentum, TWAP, Market Maker, Retail) that trade concurrently, each with unique strategies, risk management, and inventory skew logic.</li>
                            <li><strong>Lock-Free Concurrency:</strong> Implements a sophisticated, lock-free double-buffering pattern to feed market data to the GUI, allowing the simulation and visualization to run in parallel without ever blocking each other.</li>
                            <li><strong>Realistic Microstructure:</strong> Agents simulate real-world HFT strategies, like dynamic spread quoting based on volatility, creating a living, breathing, and realistic market environment.</li>
                        </ul>
                         <p class="project-link" style="font-size: 1rem; display: inline-block; margin-right: 15px;">
                            <!-- USER REQUEST 2: Fixed broken href -->
                            <a href="https://github.com/Akul-Chordia/OrderBook" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                        </p>
                         <p class="project-link" style="font-size: 1rem; display: inline-block;">
                            <!-- USER REQUEST 2: Fixed broken href -->
                            <a href="https://drive.google.com/file/d/1EKnLIR5I_yJ3Pvp-evykr0w8DyEPqujV/view?usp=sharing" target="_blank" rel="noopener noreferrer">[Read Whitepaper]</a>
                        </p>
                    </div>
                    <div class="slide-media">
                        <!-- USER REQUEST 2: Replaced broken img src with a placeholder -->
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=OrderBook+Screenshot" alt="OrderBook Project Screenshot">
                        <!-- USER REQUEST 2: Fixed broken video poster URL -->
                        <video controls poster="https://placehold.co/600x400/111111/5E98D9?text=OrderBook+Agent+Simulation">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>


                <!-- Slide 2: CPU Simulator -->
                <div class="project-slide" id="slide-2">
                    <h2>CPU Simulator (C++)</h2>
                    <div class="slide-content">
                        <p>Engineered a functional CPU from first principles using only AND/NOT gates and a custom-implemented assembly language.</p>
                        <ul>
                            <li>Features a comprehensive CLI for program loading.</li>
                            <li>Includes step-by-step debugging, register status monitoring, and full execution control.</li>
                            <li>Provides a solid foundation for educational tools, hardware simulation, or low-level system research.</li>
                        </ul>
                        <p class="project-link" style="font-size: 1rem;">
                            <a href="https://github.com/Akul-Chordia/Virtual_CPU" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                        </p>
                    </div>
                    <div class="slide-media">
                        <!-- Replace with your actual image -->
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=CPU+Simulator+Demo" alt="CPU Simulator Project Screenshot">
                    </div>
                </div>
                
                <!-- Slide 3: Exon Detection -->
                <div class="project-slide" id="slide-3">
                    <h2>Exon Detection (Python)</h2>
                    <div class="slide-content">
                        <p>Built and optimized several types of CNN algorithms (PSO, PO, RIME, AVOA) for the detection and classification of Exon segments in human DNA.</p>
                        <ul>
                            <li>Part of an ongoing research project.</li>
                            <li>Currently in the process of getting a research paper approved under a research guide.</li>
                        </ul>
                         <p class="project-link" style="font-size: 1rem;">
                            <a href="https://drive.google.com/file/d/1Q-LIQA9YiPvn_X9bg_QgsygbGy8X8pYL/view?usp=sharing" target="_blank" rel="noopener noreferrer">[Read Whitepaper]</a>
                        </p>
                    </div>
                    <div class="slide-media">
                        <!-- Replace with your actual image -->
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=DNA+Sequence+Analysis" alt="Exon Detection Project">
                    </div>
                </div>
                
                <!-- USER REQUEST 3: Added Slide 4 -->
                <!-- Slide 4: Narrative Game Engine -->
                <div class="project-slide" id="slide-4">
                    <h2>Narrative Game Engine (C++)</h2>
                    <div class="slide-content">
                        <p>A personal project to understand cross-platform development by porting a Windows-based OpenGL engine to macOS.</p>
                        <ul>
                            <li>Reworked the entire windowing, input, and rendering backends to be platform-agnostic.</li>
                            <li>Demonstrates adaptability in systems-level engineering and low-level graphics APIs.</li>
                            <li>Serves as a foundation for future cross-platform game engine development.</li>
                        </ul>
                        <p class="project-link" style="font-size: 1rem;">
                            <a href="https://github.com/Akul-Chordia/Narrative-Engine" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                        </p>
                    </div>
                    <div class="slide-media">
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=Game+Engine+Code" alt="Narrative Game Engine">
                    </div>
                </div>
                
                <!-- USER REQUEST 3: Added Slide 5 (Grid) -->
                <!-- Slide 5: Quantitative Finance Toolkit -->
                <div class="project-slide" id="slide-5">
                    <h2>Quantitative Finance Toolkit (C++ & Python)</h2>
                    <div class="slide-content">
                        <p>A collection of high-performance models and simulations for financial derivatives and market analysis.</p>
                        <div class="project-grid">
                            <div class="project-grid-item">
                                <h4>Options Pricing</h4>
                                <p>Black-Scholes, Binomial, and Monte Carlo models in C++.</p>
                                <a href="https://github.com/Akul-Chordia/options_pricing" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                            </div>
                            <div class="project-grid-item">
                                <h4>Option Payoff Graph</h4>
                                <p>Robinhood-style payoff visualizer built in Python.</p>
                                <a href="https://github.com/Akul-Chordia/option_expiration_graph" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                            </div>
                            <div class="project-grid-item">
                                <h4>Auction-Style Pricing</h4>
                                <p>Simulates price discovery and maximizing fills in an auction.</p>
                                <a href="https://github.com/Akul-Chordia/auction_pricing" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                            </div>
                            <div class="project-grid-item">
                                <h4>Statistical Arbitrage</h4>
                                <p>A classic pairs trading strategy implementation in Python.</p>
                                <a href="https://github.com/Akul-Chordia/Statistical_Arbitrage" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                            </div>
                        </div>
                    </div>
                    <div class="slide-media">
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=Quant+Finance+Models" alt="Quantitative Finance Toolkit">
                    </div>
                </div>
                
                <!-- USER REQUEST 3: Added Slide 6 -->
                <!-- Slide 6: Shopeasy -->
                <div class="project-slide" id="slide-6">
                    <h2>Shopeasy (Flutter)</h2>
                    <div class="slide-content">
                        <p>A real-time, collaborative retail cart system built with Flutter for cross-platform mobile deployment.</p>
                        <ul>
                            <li>Allows multiple users to add items to a shared cart in real-time.</li>
                            <li>Uses a cloud database (like Firebase) to sync state across devices instantly.</li>
                            <li>Designed for a seamless and modern in-store shopping experience.</li>
                        </ul>
                        <p class="project-link" style="font-size: 1rem;">
                            <a href="https://github.com/Akul-Chordia/shopeasy" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                        </p>
                    </div>
                    <div class="slide-media">
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=Shopeasy+App+Screen+1" alt="Shopeasy App Screenshot 1">
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=Shopeasy+App+Screen+2" alt="Shopeasy App Screenshot 2">
                    </div>
                </div>

                <!-- USER REQUEST 3: Added Slide 7 -->
                <!-- Slide 7: FOCUS -->
                <div class="project-slide" id="slide-7">
                    <h2>FOCUS (Flask)</h2>
                    <div class="slide-content">
                        <p>An LLM-based web application for the preliminary diagnosis of ADHD, developed for the Electra 2024 hackathon (Winner).</p>
                        <ul>
                            <li>Utilizes a fine-tuned large language model to analyze user-provided inputs.</li>
                            <li>Built with a lightweight Flask backend to serve the model and a simple frontend for interaction.</li>
                            <li>Demonstrates the application of modern AI techniques to solve real-world healthcare challenges.</li>
                        </ul>
                        <p class="project-link" style="font-size: 1rem;">
                            <a href="https://github.com/Akul-Chordia/FOCUS" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                        </p>
                    </div>
                    <div class="slide-media">
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=FOCUS+Web+App" alt="FOCUS App Screenshot">
                    </div>
                </div>
                
                <!-- USER REQUEST 3: Added Slide 8 -->
                <!-- Slide 8: Bettr -->
                <div class="project-slide" id="slide-8">
                    <h2>Bettr (Django)</h2>
                    <div class="slide-content">
                        <p>A web platform for creating and managing custom contract betting among users, built with Django.</p>
                        <ul>
                            <li>Leverages the Django framework for rapid development, including user authentication, database management, and a robust backend.</li>
                            <li>Allows users to define the terms of a bet, set stakes, and resolve outcomes.</li>
                            <li>Explores concepts of peer-to-peer agreements and web-based financial interactions.</li>
                        </ul>
                        <p class="project-link" style="font-size: 1rem;">
                            <a href="https://github.com/Akul-Chordia/bettr" target="_blank" rel="noopener noreferrer">[View on GitHub]</a>
                        </p>
                    </div>
                    <div class="slide-media">
                        <img src="https://placehold.co/600x400/111111/5E98D9?text=Bettr+Web+App" alt="Bettr App Screenshot">
                    </div>
                </div>

            </div>
        </div>
    </div>


    <script>
        // This script block contains all the logic for dragging, resizing, and interactivity.
        document.addEventListener('DOMContentLoaded', () => {

            // --- Set initial window layout based on viewport ---
            initializeWindowLayout();

            // --- Canvas and Background State ---
            const canvas = document.getElementById('background-canvas');
            const ctx = canvas.getContext('2d');
            let mouseX = window.innerWidth / 2;
            let mouseY = window.innerHeight / 2;

            // --- Global State ---
            let maxZ = 100;
            let topWindow = document.querySelector('.imgui-window.active');
            
            // Store for initial window styles
            const initialWindowStyles = new Map();
            // Only select windows inside the panned container
            const windows = document.querySelectorAll('#window-container .imgui-window');
            const debugWindow = document.getElementById('debug-window'); // Get debug window
            
            // Store for initial collapsible states
            const initialOpenStates = new Map();
            document.querySelectorAll('details').forEach(d => {
                initialOpenStates.set(d, d.open);
            });

            // Store for initial scale
            const windowContainer = document.getElementById('window-container');
            const fontSlider = document.getElementById('font-slider');
            const fontValue = document.getElementById('font-value');
            let baseFontSize = 17;

            // --- Auto-set initial font size ---
            if (window.innerWidth > 1920) {
                baseFontSize = 19;
            } else if (window.innerWidth <= 1440 && window.innerWidth > 800) {
                baseFontSize = 14;
            }
            document.documentElement.style.fontSize = baseFontSize + 'px';
            fontSlider.value = baseFontSize;
            fontValue.textContent = baseFontSize;
            // --- End auto-set ---

            // Panning state
            let panX = 0;
            let panY = 0;


            // --- Initialize Window Positions and Z-Index ---
            windows.forEach(w => {
                // Save initial style for reset
                initialWindowStyles.set(w, w.getAttribute('style'));

                const z = parseInt(w.style.zIndex, 10);
                if (z > maxZ) {
                    maxZ = z;
                    topWindow = w; // The highest z-index is the top window
                }
            });
            
            // Ensure the highest z-index window also has the .active class
            if (topWindow) {
                // Only affect panned windows
                document.querySelectorAll('#window-container .imgui-window').forEach(w => w.classList.remove('active'));
                topWindow.classList.add('active');
            }

            // --- Dynamically set initial window layout ---
            function initializeWindowLayout() {
                // Don't run on mobile, CSS handles it
                if (window.innerWidth <= 800) return;

                const vw = window.innerWidth;
                const vh = window.innerHeight;

                const layouts = {
                    'window-about':       { top: vh * 0.02, left: vw * 0.01, width: vw * 0.18, height: vh * 0.30, z: 101 },
                    'window-education':   { top: vh * 0.35, left: vw * 0.01, width: vw * 0.18, height: vh * 0.40, z: 102 },
                    'window-experience':  { top: vh * 0.02, left: vw * 0.20, width: vw * 0.35, height: vh * 0.45, z: 103 },
                    'window-projects':    { top: vh * 0.50, left: vw * 0.21, width: vw * 0.40, height: vh * 0.48, z: 104 }, // Overlaps
                    'window-achievements':{ top: vh * 0.02, left: vw * 0.56, width: vw * 0.26, height: vh * 0.35, z: 105 }, // Overlaps
                    'window-skills':      { top: vh * 0.40, left: vw * 0.63, width: vw * 0.35, height: vh * 0.45, z: 106 },  // Overlaps
                    /* NEW: Layout for portfolio button window */
                    'window-portfolio-btn': { top: vh * 0.78, left: vw * 0.01, width: vw * 0.18, height: vh * 0.18, z: 102 }
                };

                for (const id in layouts) {
                    const win = document.getElementById(id);
                    if (win) {
                        const layout = layouts[id];
                        win.style.top = `${layout.top}px`;
                        win.style.left = `${layout.left}px`;
                        win.style.width = `${layout.width}px`;
                        win.style.height = `${layout.height}px`;
                        win.style.zIndex = layout.z;
                    }
                }
            }


            // --- Make all windows interactive ---
            windows.forEach(makeWindowInteractive);
            makeWindowInteractive(debugWindow); // Apply to debug window

            function makeWindowInteractive(windowElement) {
                const titleBar = windowElement.querySelector('.imgui-title-bar');
                const resizeHandle = windowElement.querySelector('.imgui-resize-handle');
                const collapseBtn = windowElement.querySelector('.window-collapse-btn');
                
                // --- 1. Bring to Front Logic ---
                function bringToFront() {
                    // Don't do this on mobile
                    if (window.innerWidth <= 800) return;
                    
                    // Don't run if it's the debug window
                    if (windowElement.id === 'debug-window' && !windowElement.classList.contains('collapsed')) return;
                    
                    // Don't run if it's already the top window
                    if (windowElement.classList.contains('active')) return;

                    // Remove 'active' class from the *current* top window
                    const currentActive = document.querySelector('#window-container .imgui-window.active');
                    if (currentActive) {
                        currentActive.classList.remove('active');
                    }

                    maxZ++; // Increment the global z-index
                    windowElement.style.zIndex = maxZ;
                    windowElement.classList.add('active'); // Add 'active' class to this window
                }
                
                // Add mousedown listener only if it's not the debug window (or if it is, for bringing to front)
                windowElement.addEventListener('mousedown', bringToFront, { capture: true });


                // --- 2. Dragging Logic ---
                if (titleBar) {
                    titleBar.addEventListener('mousedown', (e) => {
                        // Don't drag on mobile or when clicking on links or other widgets
                        if (window.innerWidth <= 800 || e.target.closest('button, input, a, summary, .window-collapse-btn')) return;
                        
                        // UPDATED: Don't drag debug 
                        // Portfolio button window is now resizable, so it should be draggable
                        if (windowElement.id === 'debug-window') return;
                        
                        e.preventDefault();
                        bringToFront(); // This will also handle the active state
                        
                        // No longer scaling!
                        const currentScale = 1.0; 
                        
                        const startX = e.clientX - (windowElement.offsetLeft);
                        const startY = e.clientY - (windowElement.offsetTop);

                        function onMouseMove(moveEvent) {
                            let newX = (moveEvent.clientX - startX);
                            let newY = (moveEvent.clientY - startY);

                            windowElement.style.left = newX + 'px';
                            windowElement.style.top = newY + 'px';
                        }

                        function onMouseUp() {
                            document.removeEventListener('mousemove', onMouseMove);
                            document.removeEventListener('mouseup', onMouseUp);
                        }

                        document.addEventListener('mousemove', onMouseMove);
                        document.addEventListener('mouseup', onMouseUp);
                    });
                }

                // --- 3. Resizing Logic ---
                if (resizeHandle) {
                    resizeHandle.addEventListener('mousedown', (e) => {
                        // Don't resize on mobile
                        if (window.innerWidth <= 800) return;

                        e.preventDefault();
                        e.stopPropagation();
                        bringToFront(); // This will also handle the active state
                        
                        const startWidth = windowElement.offsetWidth;
                        const startHeight = windowElement.offsetHeight;
                        const startMouseX = e.clientX;
                        const startMouseY = e.clientY;
                        
                        // No longer scaling!
                        const currentScale = 1.0; 

                        function onMouseMove(moveEvent) {
                            const deltaX = (moveEvent.clientX - startMouseX) / currentScale;
                            const deltaY = (moveEvent.clientY - startMouseY) / currentScale;
                            
                            windowElement.style.width = (startWidth + deltaX) + 'px';
                            windowElement.style.height = (startHeight + deltaY) + 'px';
                        }

                        function onMouseUp() {
                            document.removeEventListener('mousemove', onMouseMove);
                            document.removeEventListener('mouseup', onMouseUp);
                        }

                        document.addEventListener('mousemove', onMouseMove);
                        document.addEventListener('mouseup', onMouseUp);
                    });
                }
                
                // --- 4. Collapse Logic ---
                if (collapseBtn) {
                    collapseBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation(); // Don't trigger drag/activate
                        
                        const isCollapsed = windowElement.classList.toggle('collapsed');
                        
                        // Update button title
                        if (isCollapsed) {
                            collapseBtn.title = 'Expand';
                        } else {
                            collapseBtn.title = 'Expand';
                            // When expanding, bring to front
                            bringToFront();
                        }
                    });
                }
            }
            
            // --- Panning Logic ---
            document.body.addEventListener('mousedown', (e) => {
                // Only pan when clicking on the body/container itself, not a window or widget
                if (e.target === document.body || e.target === windowContainer) {
                    e.preventDefault();
                    
                    const startX = e.clientX;
                    const startY = e.clientY;
                    const startPanX = panX;
                    const startPanY = panY;

                    function onMouseMove(moveEvent) {
                        const deltaX = moveEvent.clientX - startX;
                        const deltaY = moveEvent.clientY - startY;
                        
                        panX = startPanX + deltaX;
                        panY = startPanY + deltaY;
                        
                        windowContainer.style.transform = `translate(${panX}px, ${panY}px)`;
                    }

                    function onMouseUp() {
                        document.removeEventListener('mousemove', onMouseMove);
                        document.removeEventListener('mouseup', onMouseUp);
                    }

                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('mouseup', onMouseUp);
                }
            });


            // --- Button Event Listeners ---
            
            // Resume Button
            const resumeButton = document.getElementById('resume-button');
            if (resumeButton) {
                resumeButton.addEventListener('click', () => {
                    // Make sure 'Akul-resume.pdf' is in the same folder!
                    window.open('Akul-resume.pdf', '_blank');
                });
            }

            // Reset Layout Button
            const resetButton = document.getElementById('reset-layout-button');
            if (resetButton) {
                resetButton.addEventListener('click', () => {
                    // 1. Reset window positions and sizes
                    windows.forEach(win => {
                        win.setAttribute('style', initialWindowStyles.get(win));
                        win.classList.remove('collapsed');
                        // Reset collapse button text
                        const btn = win.querySelector('.window-collapse-btn');
                        if (btn) {
                            btn.title = 'Collapse';
                        }
                    });
                    
                    // 2. Re-initialize z-index and active state
                    maxZ = 100;
                    topWindow = null;
                    document.querySelectorAll('#window-container .imgui-window').forEach(w => {
                        w.classList.remove('active'); // Clear all
                        const z = parseInt(w.style.zIndex, 10);
                        if (z > maxZ) {
                            maxZ = z;
                            topWindow = w;
                        }
                    });
                    // Find the window with the highest z-index from the *original* styles
                    let maxOriginalZ = -1;
                    let newTopWindow = null;
                    initialWindowStyles.forEach((style, win) => {
                        // Need to parse z-index from the style string
                        let z = 100; // default
                        if(style) {
                             const zMatch = style.match(/z-index:\s*(\d+)/);
                             if(zMatch) z = parseInt(zMatch[1], 10);
                        }
                       
                        if(z > maxOriginalZ) {
                            maxOriginalZ = z;
                            newTopWindow = win;
                        }
                    });
                    if(newTopWindow) {
                        newTopWindow.classList.add('active');
                        maxZ = maxOriginalZ; // Reset maxZ
                    }
                    
                    // 3. Reset collapsible states
                    initialOpenStates.forEach((isOpen, el) => {
                        el.open = isOpen;
                    });
                    
                    // 4. Reset UI scale
                    fontSlider.value = baseFontSize;
                    fontValue.textContent = baseFontSize;
                    document.documentElement.style.fontSize = baseFontSize + 'px';
                    
                    // 5. Reset pan
                    panX = 0;
                    panY = 0;
                    windowContainer.style.transform = `translate(0, 0)`;
                });
            }


            // --- Scale Slider Logic ---
            if (fontSlider) {
                fontSlider.addEventListener('input', (e) => {
                    const size = e.target.value;
                    fontValue.textContent = size;
                    document.documentElement.style.fontSize = size + 'px';
                });
            }

            // --- Theme Radio Button Logic ---
            document.getElementById('theme-dark').addEventListener('change', () => {
                document.body.classList.remove('light-mode');
            });
            document.getElementById('theme-light').addEventListener('change', () => {
                document.body.classList.add('light-mode');
            });


            // --- Real-time Stats Logic ---
            const appStats = document.getElementById('app-stats');
            const mouseStats = document.getElementById('mouse-stats');
            
            // Mouse Tracking
            document.addEventListener('mousemove', e => {
                mouseX = e.clientX;
                mouseY = e.clientY;
                
                if (mouseStats) {
                    mouseStats.textContent = `Mouse: (${e.clientX}, ${e.clientY})`;
                }
            });

            // --- Canvas Resize ---
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas(); // Initial call

            // --- Animation Loop ---
            let frameCount = 0;
            let fps = 0;
            let lastFpsUpdate = performance.now();

            // Background draw function
            function drawBackground() {
                const isLightMode = document.body.classList.contains('light-mode');
                
                // --- 1. Get colors based on theme ---
                const bgColor = isLightMode ? 'rgb(0, 0, 0)' : 'rgb(255, 255, 255)';
                const dotColor = isLightMode ? 'rgba(255, 255, 255, 0.10)' : 'rgba(35, 35, 35, 0.10)'; // Light grey dots
                const spotlightColor = isLightMode ? 'rgba(255, 255, 255, 0.2)' : 'rgba(255, 255, 255, 0.08)';
                const gradientTop = isLightMode ? 'rgba(255, 255, 255, 0.05)' : 'rgba(255, 255, 255, 0.03)';
                const gradientBottom = isLightMode ? 'rgba(0, 0, 0, 0.05)' : 'rgba(0, 0, 0, 0.03)';

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // --- 2. Slight Gradient ---
                // Use the base color
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Add a very subtle linear gradient on top
                const linearGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);
                linearGrad.addColorStop(0, gradientTop);
                linearGrad.addColorStop(1, gradientBottom);
                ctx.fillStyle = linearGrad;
                ctx.fillRect(0, 0, canvas.width, canvas.height);


                // --- 3. Dots + Warp ---
                const dotSpacing = 30;
                const dotRadius = 75;
                const maxWarpRadius = 250;
                const warpStrength = 20;

                // Offset the grid by panX and panY
                const offsetX = panX % dotSpacing;
                const offsetY = panY % dotSpacing;

                ctx.fillStyle = dotColor;

                for (let x = offsetX - dotSpacing; x < canvas.width + dotSpacing; x += dotSpacing) {
                    for (let y = offsetY - dotSpacing; y < canvas.height + dotSpacing; y += dotSpacing) {
                        
                        const dotCanvasX = x;
                        const dotCanvasY = y;
                        
                        let finalX = dotCanvasX;
                        let finalY = dotCanvasY;

                        // Calculate distance from mouse to the dot's *canvas* position
                        const distX = dotCanvasX - mouseX;
                        const distY = dotCanvasY - mouseY;
                        const distance = Math.sqrt(distX * distX + distY * distY);

                        if (distance > 0.1 && distance < maxWarpRadius) {
                            const warpAmount = (maxWarpRadius - distance) / maxWarpRadius; // 1 at center, 0 at edge
                            // Move dot *towards* mouse
                            finalX = dotCanvasX - (distX / distance) * warpAmount * warpStrength;
                            finalY = dotCanvasY - (distY / distance) * warpAmount * warpStrength;
                        }

                        ctx.beginPath();
                        ctx.arc(finalX, finalY, dotRadius, 0, 2 * Math.PI);
                        ctx.fill();
                    }
                }
                
                // --- 4. Spotlight ---
                const spotlightRadius = 300;
                const spotlight = ctx.createRadialGradient(mouseX, mouseY, 0, mouseX, mouseY, spotlightRadius);
                spotlight.addColorStop(0, spotlightColor);
                spotlight.addColorStop(0.8, 'rgba(0, 0, 0, 0)'); // Fade out quicker
                spotlight.addColorStop(1, 'rgba(0, 0, 0, 0)');
                
                ctx.fillStyle = spotlight;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            function animateLoop(timestamp) {
                // --- Draw Background ---
                // Only draw if not on mobile (where canvas is hidden)
                if (window.innerWidth > 800) {
                    drawBackground();
                } else {
                    // Clear canvas on mobile just in case
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }


                // --- Update Stats ---
                frameCount++;
                
                // Update stats once per second
                if (timestamp - lastFpsUpdate > 1000) {
                    fps = frameCount;
                    frameCount = 0;
                    lastFpsUpdate = timestamp;
                }
                
                if (appStats && fps > 0) {
                    const frameTime = 1000 / fps;
                    appStats.textContent = `App: ${frameTime.toFixed(1)} ms/frame (${fps} FPS)`;
                } else if (appStats) {
                    appStats.textContent = `App: ... ms/frame (0 FPS)`;
                }

                requestAnimationFrame(animateLoop);
            }
            // Start the animation loop
            requestAnimationFrame(animateLoop);

            
            // --- Style Debug Widgets to look exactly like ImGui ---
            const styleSheet = document.createElement("style");
            styleSheet.textContent = `
                .debug-widget {
                    display: block;
                    width: 100%;
                    margin: 10px 0; 
                }
                /* UPDATED: Removed #debug-button */
                #resume-button, #reset-layout-button, #portfolio-button { 
                    padding: 8px 14px; 
                    background-color: rgb(41, 74, 122);
                    border: 1px solid rgb(41, 74, 122);
                    color: #E0E0E0;
                    font-weight: 700;
                    /* Updated font stack and size */
                    font-family: 'ProggyClean', 'Roboto Mono', 'Courier New', 'Bitstream Vera Sans Mono', monospace;
                    font-size: 16px; 
                    cursor: pointer;
                    width: 100%;
                    transition: background-color 0.2s, border-color 0.2s, color 0.2s;
                }
                /* UPDATED: Removed #debug-button */
                #resume-button:hover, #reset-layout-button:hover, #portfolio-button:hover { 
                    background-color: rgb(56, 123, 203);
                    border-color: rgb(56, 123, 203);
                }
                /* UPDATED: Removed #debug-button */
                #resume-button:active, #reset-layout-button:active, #portfolio-button:active { 
                    background-color: rgb(32, 58, 89);
                    border-color: rgb(32, 58, 89);
                }
                
                /* --- Custom Slider --- */
                /* UPDATED: Removed #debug-slider */
                #font-slider {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 100%;
                    height: 10px; 
                    background: #353535;
                    outline: none;
                    border: 1px solid rgb(17, 17, 17);
                    transition: background-color 0.2s, border-color 0.2s;
                }
                /* UPDATED: Removed #debug-slider */
                #font-slider::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 20px; 
                    height: 20px; 
                    background: rgb(41, 74, 122);
                    border: 1px solid rgb(56, 123, 203);
                    cursor: grab;
                    transition: background-color 0.2s, border-color 0.2s;
                }
                /* UPDATED: Removed #debug-slider */
                #font-slider::-webkit-slider-thumb:hover {
                    background: rgb(56, 123, 203);
                }
                /* UPDATED: Removed #debug-slider */
                #font-slider::-moz-range-thumb {
                    width: 20px; 
                    height: 20px; 
                    background: rgb(41, 74, 122);
                    border: 1px solid rgb(56, 123, 203);
                    cursor: grab;
                    transition: background-color 0.2s, border-color 0.2s;
                }
            `;
            document.head.appendChild(styleSheet);


            // --- NEW: Portfolio Overlay Logic ---

            // 1. Get DOM elements for overlay
            const portfolioBtn = document.getElementById('portfolio-button'); // UPDATED: Just get the button
            const overlay = document.getElementById('portfolio-overlay');
            const closeBtn = document.getElementById('portfolio-close-btn');
            const portfolioCard = document.getElementById('portfolio-card'); // NEW: Get the card for animation

            // 2. Add event listeners
            if (overlay && portfolioBtn && closeBtn && portfolioCard) { // UPDATED: Check for card
                // Open overlay
                portfolioBtn.addEventListener('click', () => {
                    overlay.classList.remove('hiding'); // NEW: Remove hiding class if it's there
                    overlay.classList.add('active');
                });

                // NEW: Function to close overlay
                function closeOverlay() {
                    overlay.classList.add('hiding');
                }

                // Close overlay with 'X' button
                closeBtn.addEventListener('click', closeOverlay); // UPDATED

                // Close overlay by clicking on the backdrop
                overlay.addEventListener('click', (e) => { // UPDATED
                    // Only close if the click is on the overlay itself, not the card
                    if (e.target === overlay) {
                        closeOverlay();
                    }
                });
                
                // NEW: Listen for animation end to fully hide
                portfolioCard.addEventListener('animationend', (e) => {
                    if (e.animationName === 'popOut') {
                        overlay.classList.remove('active');
                        overlay.classList.remove('hiding');
                    }
                });
            }
            
            // --- NEW: Portfolio Fan Interaction Logic ---
            function initPortfolioFan() {
                // This logic is only for the desktop fan view
                if (window.innerWidth <= 800) return;

                const scroller = document.getElementById('portfolio-scroller');
                const slides = Array.from(scroller.querySelectorAll('.project-slide'));
                const numSlides = slides.length;
                
                if (numSlides === 0) return;

                // --- STATE VARIABLES ---
                let activeIndex = -1;
                
                // NEW: Pixel accumulator for scrolling
                let scrollAccumulator = 0;
                const scrollThresholdPx = 250; // Must swipe 250px to trigger
                
                // NEW: State for directional hover
                let previousHoveredIndex = -1;
                
                // NEW: Store entry point for the *current* hover
                let hoverEntry = { index: -1, x: 0, y: 0 };
                const activationThresholdPx = 40; // USER REQUEST: 40px threshold

                // 1. Define the default "fan" transforms (copied from CSS)
                const defaultTransforms = [
                    { transform: 'translateX(-35rem) translateY(9rem) rotate(-24deg) scale(0.7)', zIndex: 1 },
                    { transform: 'translateX(-25rem) translateY(5rem) rotate(-16deg) scale(0.8)', zIndex: 2 },
                    { transform: 'translateX(-15rem) translateY(2rem) rotate(-8deg) scale(0.9)', zIndex: 3 },
                    { transform: 'translateX(-5rem) translateY(0rem) rotate(-2deg) scale(1)', zIndex: 4 },
                    { transform: 'translateX(5rem) translateY(0rem) rotate(2deg) scale(1)', zIndex: 4 },
                    { transform: 'translateX(15rem) translateY(2rem) rotate(8deg) scale(0.9)', zIndex: 3 },
                    { transform: 'translateX(25rem) translateY(5rem) rotate(16deg) scale(0.8)', zIndex: 2 },
                    { transform: 'translateX(35rem) translateY(9rem) rotate(24deg) scale(0.7)', zIndex: 1 }
                ];

                // 2. Helper function to apply a set of transforms
                function applyTransforms(transformSet) {
                    slides.forEach((slide, i) => {
                        // Failsafe in case transformSet is shorter
                        if (!transformSet[i]) return; 
                        
                        slide.style.transform = transformSet[i].transform;
                        slide.style.zIndex = transformSet[i].zIndex;
                    });
                }

                // 3. NEW: Helper function to activate a card
                function activateCard(index) {
                    if (index === activeIndex) return; // Already active
                    
                    // Clamp index
                    index = Math.max(0, Math.min(numSlides - 1, index));
                    
                    activeIndex = index;

                    const hoverTransforms = [];
                    
                    // Define the "move aside" parameters
                    const xBase = 30; // Base separation from center (rem)
                    const xPer = 10;  // Additional separation per card (rem)
                    const yPer = 3;   // Y offset per card (rem)
                    const rotPer = 5; // Rotation per card (deg)
                    const scaleBase = 0.8; // Base scale of "aside" cards
                    
                    slides.forEach((s, i) => {
                        if (i === activeIndex) {
                            // FOCUSED card
                            hoverTransforms.push({
                                transform: 'translateY(-2.5rem) scale(1.1)',
                                zIndex: 100
                            });
                        } else {
                            // "ASIDE" card
                            const distance = i - activeIndex;
                            const sign = Math.sign(distance); // -1 for left, 1 for right
                            
                            const x = (sign * xBase) + (distance * xPer);
                            const y = Math.abs(distance) * yPer;
                            const rot = (sign * 10) + (distance * rotPer); // Base rotation + per-card rotation
                            const scale = Math.pow(scaleBase, Math.abs(distance));
                            const z = numSlides - Math.abs(distance);
                            
                            hoverTransforms.push({
                                transform: `translateX(${x}rem) translateY(${y}rem) rotate(${rot}deg) scale(${scale})`,
                                zIndex: z
                            });
                        }
                    });
                    
                    applyTransforms(hoverTransforms);
                }

                // 4. NEW: Helper function to reset all cards
                function deactivateAll() {
                    activeIndex = -1; // Reset active index
                    applyTransforms(defaultTransforms);
                }

                // 5. Set the default state on load
                applyTransforms(defaultTransforms);


                // 6. NEW: Replace all mouseenter/mouseleave with a single mousemove
                scroller.addEventListener('mousemove', (e) => {
                    const hoveredSlide = e.target.closest('.project-slide');
                    const currentHoveredIndex = hoveredSlide ? slides.indexOf(hoveredSlide) : -1;
                    
                    if (currentHoveredIndex === -1) {
                        // On background
                        previousHoveredIndex = -1;
                        hoverEntry = { index: -1, x: 0, y: 0 };
                        return;
                    }

                    if (currentHoveredIndex === activeIndex) {
                        // On active card
                        previousHoveredIndex = currentHoveredIndex;
                        hoverEntry = { index: -1, x: 0, y: 0 }; // Reset hover entry
                        return;
                    }

                    // --- We are on an INACTIVE card ---

                    if (currentHoveredIndex !== hoverEntry.index) {
                        // This is the FIRST time we're on this *new* inactive card
                        previousHoveredIndex = hoverEntry.index; // Store the card we *just* left
                        hoverEntry = { index: currentHoveredIndex, x: e.clientX, y: e.clientY };
                        return; // Wait for 20px movement
                    }

                    // --- We are STILL on the SAME inactive card ---
                    
                    // NEW: Calculate directional distance
                    const deltaX = e.clientX - hoverEntry.x;
                    const prevActiveIndex = activeIndex; // Get the *current* active card
                    
                    let directionalDist = 0;
                    
                    if (prevActiveIndex === -1) {
                        // No card active, so any movement counts. Use total distance.
                        directionalDist = Math.sqrt(Math.pow(e.clientX - hoverEntry.x, 2) + Math.pow(e.clientY - hoverEntry.y, 2));
                    } else if (currentHoveredIndex > prevActiveIndex) {
                        // We are on a card to the RIGHT. Only count positive X movement.
                        if (deltaX > 0) directionalDist = deltaX;
                    } else if (currentHoveredIndex < prevActiveIndex) {
                        // We are on a card to the LEFT. Only count negative X movement.
                        if (deltaX < 0) directionalDist = Math.abs(deltaX);
                    }
                    
                    // Also need to handle the case of moving *off* the active card
                    if (previousHoveredIndex === prevActiveIndex) {
                        // We just left the active card. Any 20px move counts.
                        directionalDist = Math.sqrt(Math.pow(e.clientX - hoverEntry.x, 2) + Math.pow(e.clientY - hoverEntry.y, 2));
                    }


                    if (directionalDist > activationThresholdPx) {
                        // --- We've moved 20px IN THE RIGHT DIRECTION! ---
                        
                        // Now, we can run the original logic
                        if (prevActiveIndex === -1) {
                            activateCard(currentHoveredIndex);
                        } else if (previousHoveredIndex === prevActiveIndex) {
                            activateCard(currentHoveredIndex);
                        } else if (previousHoveredIndex !== -1) {
                            const distPrev = Math.abs(previousHoveredIndex - prevActiveIndex);
                            const distCurr = Math.abs(currentHoveredIndex - prevActiveIndex);

                            if (distCurr > distPrev) {
                                activateCard(currentHoveredIndex);
                            }
                        } else if (previousHoveredIndex === -1) {
                             activateCard(currentHoveredIndex);
                        }
                        
                        // Reset hover entry so this logic block doesn't re-fire
                        // We'll set a new entry point on the *next* mousemove frame
                        hoverEntry = { index: -1, x: 0, y: 0 };
                    }
                });
                
                // 7. NEW: Add mouseleave to scroller to reset
                scroller.addEventListener('mouseleave', () => {
                    deactivateAll();
                    previousHoveredIndex = -1; // Reset state
                    hoverEntry = { index: -1, x: 0, y: 0 }; // Reset state
                });


                // 8. NEW: Listen for scroll/wheel events (Scroll Navigation)
                scroller.addEventListener('wheel', (e) => {
                    e.preventDefault(); // Stop page from scrolling
                    
                    // Only act on horizontal scroll
                    if (Math.abs(e.deltaX) < Math.abs(e.deltaY)) {
                        return; // It's a vertical scroll, ignore it
                    }

                    // Add this scroll's pixels to the accumulator
                    scrollAccumulator += e.deltaX;
                    
                    let newIndex = activeIndex;

                    // Check if accumulator passes the positive (right) threshold
                    if (scrollAccumulator > scrollThresholdPx) {
                        if (activeIndex === -1) {
                            // If no card is active, start from the middle
                            newIndex = Math.floor(numSlides / 2);
                        } else {
                            newIndex = activeIndex + 1;
                        }
                        activateCard(newIndex);
                        scrollAccumulator = 0; // Reset
                        
                    // Check if accumulator passes the negative (left) threshold
                    } else if (scrollAccumulator < -scrollThresholdPx) {
                         if (activeIndex === -1) {
                            // If no card is active, start from the middle
                            newIndex = Math.floor(numSlides / 2) - 1;
                         } else {
                            newIndex = activeIndex - 1;
                         }
                        activateCard(newIndex);
                        scrollAccumulator = 0; // Reset
                    }
                });

            }
            initPortfolioFan(); // Run the new function

        });
    </script>

</body>
</html>
